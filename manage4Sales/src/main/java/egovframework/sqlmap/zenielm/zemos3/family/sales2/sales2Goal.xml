<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="zenielm.zemos3.family.sales2.sales2Goal">

	<!-- 제모스 판매관리 목표 XML -->
	<!-- 매장명 -->
	<select id="selectStoreNewUseNameList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectStoreNewUseNameList */
		select zemos_idx as zemosIdx
		     , store_use_nm as storeUseNm
		  from ZM_SALES_STORE_NM
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and wrkplc_idx = #{wrkplcIdx}
		   </if>
		LIMIT 1
	</select>
	<!-- 목표등록 화면 년도 selectbox(현재년도의 이전 15년 ~ 이후 3년) -->
	<select id="selectYyyy" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectYyyy */
		SELECT DATE_FORMAT(DATE_ADD(CONCAT(YEAR(now()),'0101'), INTERVAL seq year), '%Y') AS yyyy
		 FROM (
		 	  SELECT @num := @num + 1 AS seq
				FROM information_schema.tables a
		 		   , information_schema.tables b
		 		   , (select @num := 0) c
			   limit 3
			  ) t
		union
		SELECT DATE_FORMAT(DATE_ADD(CONCAT(YEAR(now()),'0101'), INTERVAL seq year), '%Y') AS yyyy
		 FROM (
		 	  SELECT @num := @num - 1 AS seq
				FROM information_schema.tables a
		 		   , information_schema.tables b
		 		   , (select @num := 1) c
			   limit 15
			  ) t
		order by yyyy desc
	</select>
	
	<!-- 목표등록 화면 매장 selectbox -->
	<select id="selectBoxStoreList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectBoxStoreList */
		select a.zemos_idx  as zemosIdx
			 , a.wrkplc_idx as wrkplcIdx
			 , a.store_seq  as storeSeq
			 , a.store_nm   as storeNm
		  from ZM_SALES_STORE a
		       left join ZM_SALES_GOAL b on a.zemos_idx = b.zemos_idx and a.wrkplc_idx = b.wrkplc_idx and a.store_seq = b.store_seq
		       <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   and a.use_yn = 'Y'
		 group by a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
		 order by a.store_nm
	</select>

	<!-- 목표 count -->
	<select id="selectGoalCnt" parameterType="java.util.HashMap" resultType="java.lang.Integer">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectGoalCnt */
select count(*) as cnt
  FROM (
		SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit1_yn = 'Y' THEN '1' ELSE '0' END AS unitYn
				, CASE WHEN c.unit1_yn ='Y' THEN c.unit_seq1 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit1_yn = 'Y' THEN '1' ELSE '0' END AS unitYn
				, CASE WHEN c.unit1_yn ='Y' THEN c.unit_seq1 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit2_yn = 'Y' THEN '2' ELSE '0' END AS unitYn
				, CASE WHEN c.unit2_yn ='Y' THEN c.unit_seq2 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt2), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit2_yn = 'Y' THEN '2' ELSE '0' END AS unitYn
				, CASE WHEN c.unit2_yn ='Y' THEN c.unit_seq2 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt2_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit3_yn = 'Y' THEN '3' ELSE '0' END AS unitYn
				, CASE WHEN c.unit3_yn ='Y' THEN c.unit_seq3 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt3), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit3_yn = 'Y' THEN '3' ELSE '0' END AS unitYn
				, CASE WHEN c.unit3_yn ='Y' THEN c.unit_seq3 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt3_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit4_yn = 'Y' THEN '4' ELSE '0' END AS unitYn
				, CASE WHEN c.unit4_yn ='Y' THEN c.unit_seq4 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt4), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit4_yn = 'Y' THEN '4' ELSE '0' END AS unitYn
				, CASE WHEN c.unit4_yn ='Y' THEN c.unit_seq4 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt4_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit5_yn = 'Y' THEN '5' ELSE '0' END AS unitYn
				, CASE WHEN c.unit5_yn ='Y' THEN c.unit_seq5 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt5), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit5_yn = 'Y' THEN '5' ELSE '0' END AS unitYn
				, CASE WHEN c.unit5_yn ='Y' THEN c.unit_seq5 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt5_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
	) a
	WHERE 1=1
	AND unitYn <![CDATA[ <> ]]> '0'
	AND onoffNM <![CDATA[ <> ]]> '0'
	ORDER BY a.storeNm,a.unitNm,a.onoffNM
	</select>
	
	<select id="selectUnit" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectUnit */
		select unit_seq as unitSeq
		     , zemos_idx  as zemosIdx
		     , unit_nm  as unitNm
		     , use_yn     as useYn
		     , reg_dttm   as regDttm
		     , reg_user   as regUser
		     , mod_dttm   as modDttm
		     , mod_user   as modUser
		  from ZM_SALES_UNIT
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and wrkplc_idx = #{wrkplcIdx}
		   </if>
		   and use_yn = 'Y'
		 order by use_yn desc, unit_nm asc
	</select>

	<select id="selectOnoff" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectOnoff */
		 SELECT DISTINCT a.onoffYn
		 				,a.onoffNm
			FROM (
			SELECT case when on_yn = 'Y' then '온라인'
					 ELSE '' end AS onoffNm
					,case when on_yn = 'Y' then '1'
					Else '0' end AS  onoffYn
			FROM ZM_SALES_STORE
			WHERE 1=1
			<if test='zemosIdx != null and zemosIdx != ""'>
		   and zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and wrkplc_idx = #{wrkplcIdx}
		   </if>
			AND on_yn ='Y'
			UNION ALL
			SELECT case when off_yn = 'Y' then '오프라인'
					 ELSE '' end AS onoffNm
					,case when off_yn = 'Y' then '0'
					Else '1' end AS  onoffYn
			FROM ZM_SALES_STORE
			WHERE 1=1
			<if test='zemosIdx != null and zemosIdx != ""'>
		   and zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and wrkplc_idx = #{wrkplcIdx}
		   </if>
			AND off_yn ='Y') a
	</select>
	
	<!-- 목표 List -->
	<select id="selectGoal" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectGoal */ 
 SELECT a.zemosIdx
		,a.wrkplcIdx
		,a.storeSeq
		,a.storeNm
		,a.year
		,a.unitYn
		,a.unitSeq
		,a.unitNm
		,a.offYn
		,a.onYn
		,a.onoffNM
		,a.totGoal
  FROM (
		SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit1_yn = 'Y' THEN '1' ELSE '0' END AS unitYn
				, CASE WHEN c.unit1_yn ='Y' THEN c.unit_seq1 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit1_yn = 'Y' THEN '1' ELSE '0' END AS unitYn
				, CASE WHEN c.unit1_yn ='Y' THEN c.unit_seq1 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit2_yn = 'Y' THEN '2' ELSE '0' END AS unitYn
				, CASE WHEN c.unit2_yn ='Y' THEN c.unit_seq2 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt2), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit2_yn = 'Y' THEN '2' ELSE '0' END AS unitYn
				, CASE WHEN c.unit2_yn ='Y' THEN c.unit_seq2 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt2_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit3_yn = 'Y' THEN '3' ELSE '0' END AS unitYn
				, CASE WHEN c.unit3_yn ='Y' THEN c.unit_seq3 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt3), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit3_yn = 'Y' THEN '3' ELSE '0' END AS unitYn
				, CASE WHEN c.unit3_yn ='Y' THEN c.unit_seq3 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt3_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit4_yn = 'Y' THEN '4' ELSE '0' END AS unitYn
				, CASE WHEN c.unit4_yn ='Y' THEN c.unit_seq4 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt4), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit4_yn = 'Y' THEN '4' ELSE '0' END AS unitYn
				, CASE WHEN c.unit4_yn ='Y' THEN c.unit_seq4 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt4_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL 
			SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm
				, b.year       AS year
				, CASE WHEN c.unit5_yn = 'Y' THEN '5' ELSE '0' END AS unitYn
				, CASE WHEN c.unit5_yn ='Y' THEN c.unit_seq5 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) as unitNm
				, CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
				, '0'      AS onYn
				, CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
				, CASE WHEN a.off_yn = 'Y' THEN ifnull(sum(b.amt5), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq		        
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
			UNION ALL
		 SELECT  a.zemos_idx  AS zemosIdx
				, a.wrkplc_idx AS wrkplcIdx
				, a.store_seq  AS storeSeq
				, a.store_nm   AS storeNm			 
				, b.year       AS year
				, CASE WHEN c.unit5_yn = 'Y' THEN '5' ELSE '0' END AS unitYn
				, CASE WHEN c.unit5_yn ='Y' THEN c.unit_seq5 ELSE '0' END  AS unitSeq
				, (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) AS unitNm
				, '0'      AS offYn
				, CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
				, CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END     AS onoffNM
				, CASE WHEN a.on_yn = 'Y' THEN ifnull(sum(b.amt5_on), 0) ELSE '0' END AS totGoal
			FROM ZM_SALES_STORE a
			JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq
			 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
			AND a.wrkplc_idx = b.wrkplc_idx
			AND a.store_seq = b.store_seq       
			<if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
		 where 1 = 1
		   <if test='zemosIdx != null and zemosIdx != ""'>
		   and a.zemos_idx = #{zemosIdx}
		   </if>
		   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
		   and a.wrkplc_idx = #{wrkplcIdx}
		   </if>
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.use_yn = 'Y'
			GROUP BY a.zemos_idx, a.wrkplc_idx, a.store_seq, b.year
	) a
	WHERE 1=1
	AND unitYn <![CDATA[ <> ]]> '0'
	AND onoffNM <![CDATA[ <> ]]> '0'
	ORDER BY a.storeNm,a.unitNm,a.onoffNM
	</select>
	
	<!-- totla sum -->
	<select id="selectTotSumGoal" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectTotSumGoal */
		SELECT a.unitNm
				,a.offYn
				,a.onYn
				,a.onoffNM
				,a.totSumGoal
		  FROM (
				SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
						 , '0'      AS onYn
						 , CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit1_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq		        
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
						 , CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit1_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq1 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , '0' AS onYn
						 , '소계' AS onoffNM
						 ,ifnull(sum(b.amt), 0)+ifnull(sum(b.amt_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit1_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
						 , '0'      AS onYn
						 , CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt2), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit2_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
						 , CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt2_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit2_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq2 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , '0' AS onYn
						 , '소계' AS onoffNM
						 ,ifnull(sum(b.amt2), 0)+ifnull(sum(b.amt2_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit2_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
						 , '0'      AS onYn
						 , CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt3), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit3_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
						 , CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt3_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit3_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq3 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , '0' AS onYn
						 , '소계' AS onoffNM
						 ,ifnull(sum(b.amt3), 0)+ifnull(sum(b.amt3_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit4_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
						 , '0'      AS onYn
						 , CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt4), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit4_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
						 , CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt4_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit4_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq4 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , '0' AS onYn
						 , '소계' AS onoffNM
						 ,ifnull(sum(b.amt4), 0)+ifnull(sum(b.amt4_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit4_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , CASE WHEN a.off_yn = 'Y' THEN a.off_yn ELSE '0' END AS offYn
						 , '0'      AS onYn
						 , CASE WHEN a.off_yn = 'Y' THEN '오프라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt5), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit5_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				 UNION ALL 
				 SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , CASE WHEN a.on_yn = 'Y' THEN a.on_yn ELSE '0' END AS onYn
						 , CASE WHEN a.on_yn = 'Y' THEN '온라인' ELSE '0' END AS onoffNM
						 ,ifnull(sum(b.amt5_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit5_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'
				   UNION ALL
				   SELECT (SELECT d.unit_nm from ZM_SALES_UNIT d WHERE d.unit_seq = c.unit_seq5 AND d.zemos_idx = c.zemos_idx) as unitNm
						 , '0' AS offYn
						 , '0' AS onYn
						 , '소계' AS onoffNM
						 ,ifnull(sum(b.amt5), 0)+ifnull(sum(b.amt5_on), 0) AS totSumGoal
				 FROM ZM_SALES_STORE a
				 JOIN ZM_SALES_STORE_DETAIL c ON a.zemos_idx = c.zemos_idx AND a.store_seq = c.store_seq AND ifnull(c.unit5_yn,'N') ='Y'
				 LEFT JOIN ZM_SALES_GOAL b ON a.zemos_idx = b.zemos_idx
				 AND a.wrkplc_idx = b.wrkplc_idx
				 AND a.store_seq = b.store_seq	
				 <if test='yyyy != null and yyyy != ""'> and b.year = #{yyyy}</if>	        
				 where 1 = 1
				   <if test='zemosIdx != null and zemosIdx != ""'>
				   and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				   and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='storeSeq != null and storeSeq != ""'>
				   and a.store_seq = #{storeSeq}
				   </if>
				   and a.use_yn = 'Y'				 
				 ) a
		 WHERE 1=1
		   AND a.unitNm IS NOT NULL		   
		   

	</select>
	
	<!-- 목표등록 상세화면 -->
	<select id="selectGoalDetail" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectGoalDetail */
		select a.goal_seq   as goalSeq
			 , a.zemos_idx  as zemosIdx
			 , a.wrkplc_idx as wrkplcIdx
			 , a.store_seq  as storeSeq
			 , #{unitSeq} as unitSeq
			 , #{unitNm} as unitNm
			 , #{onoffNM} as onoffNM
			 , #{unitYn} as unitYn
			 , #{offYn} as offYn
			 , #{onYn} as onYn
			 , #{unitYn} as unitYn
			 , (select store_nm from ZM_SALES_STORE where zemos_idx = a.zemos_idx and wrkplc_idx = a.wrkplc_idx and store_seq = a.store_seq) as storeNm
			 , a.year       as year
			 , a.mm         as mm
			 , a.item_seq   AS itemSeq
			 , (SELECT c.item_nm FROM  ZM_SALES_ITEM c WHERE c.item_seq = a.item_seq) AS itemNm
			 <!-- 박수호 SUM 추가 -->
			 <if test='unitYn == "1"'>
			 	<if test='offYn == "Y"'>, ifnull(format(SUM(a.amt), '#,###'), 0) as amt</if>
			 	<if test='onYn == "Y"'>, ifnull(format(SUM(a.amt_on), '#,###'), 0) as amt</if>
			 </if>
			 <if test='unitYn == "2"'>
			 	<if test='offYn == "Y"'>, ifnull(format(SUM(a.amt2), '#,###'), 0) as amt</if>
			 	<if test='onYn == "Y"'>, ifnull(format(SUM(a.amt2_on), '#,###'), 0) as amt</if>
			 </if>
			 <if test='unitYn == "3"'>
			 	<if test='offYn == "Y"'>, ifnull(format(SUM(a.amt3), '#,###'), 0) as amt</if>
			 	<if test='onYn == "Y"'>, ifnull(format(SUM(a.amt3_on), '#,###'), 0) as amt</if>
			 </if>
			 <if test='unitYn == "4"'>
			 	<if test='offYn == "Y"'>, ifnull(format(SUM(a.amt4), '#,###'), 0) as amt</if>
			 	<if test='onYn == "Y"'>, ifnull(format(SUM(a.amt4_on), '#,###'), 0) as amt</if>
			 </if>
			 <if test='unitYn == "5"'>
			 	<if test='offYn == "Y"'>, ifnull(format(SUM(a.amt5), '#,###'), 0) as amt</if>
			 	<if test='onYn == "Y"'>, ifnull(format(SUM(a.amt5_on), '#,###'), 0) as amt</if>
			 </if>
			 , a.reg_dttm   as regDttm
			 , a.reg_user   as regUser
			 , a.mod_dttm   as modDttm
			 , a.mod_user   as modUser
		  from ZM_SALES_GOAL a
		 where 1 = 1
		   and a.zemos_idx = #{zemosIdx}
		   and a.wrkplc_idx = #{wrkplcIdx}
		   and a.store_seq  = #{storeSeq}
		   <if test='unitYn == "1"'> and a.unit_seq1 = #{unitSeq}</if>
		   <if test='unitYn == "2"'> and a.unit_seq2 = #{unitSeq}</if>
		   <if test='unitYn == "3"'> and a.unit_seq3 = #{unitSeq}</if>
		   <if test='unitYn == "4"'> and a.unit_seq4 = #{unitSeq}</if>
		   <if test='unitYn == "5"'> and a.unit_seq5 = #{unitSeq}</if>
		   <if test='year != null and year != ""'>and a.year = #{year}</if>
		   <!-- 박수호 group by 추가 -->
		 group by a.year, a.mm  ,a.item_seq
		 order by a.item_seq,a.year, a.mm
	</select>
	
	<!-- 목표등록 update -->
	<update id="goalUpdate" parameterType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.goalUpdate */
		update ZM_SALES_GOAL
		   set 
		   	<if test='unitYn == "1"'>	
		   		<if test='offYn == "Y"'>amt = replace(#{amt}, ',', '')</if>
		   		<if test='onYn == "Y"'>amt_on = replace(#{amt}, ',', '')</if>
		   	</if>
		   	<if test='unitYn == "2"'>	
		   		<if test='offYn == "Y"'>amt2 = replace(#{amt}, ',', '')</if>
		   		<if test='onYn == "Y"'>amt2_on = replace(#{amt}, ',', '')</if>
		   	</if>
		   	<if test='unitYn == "3"'>	
		   		<if test='offYn == "Y"'>amt3 = replace(#{amt}, ',', '')</if>
		   		<if test='onYn == "Y"'>amt3_on = replace(#{amt}, ',', '')</if>
		   	</if>
		   	<if test='unitYn == "4"'>	
		   		<if test='offYn == "Y"'>amt4 = replace(#{amt}, ',', '')</if>
		   		<if test='onYn == "Y"'>amt4_on = replace(#{amt}, ',', '')</if>
		   	</if>
		   	<if test='unitYn == "5"'>	
		   		<if test='offYn == "Y"'>amt5 = replace(#{amt}, ',', '')</if>
		   		<if test='onYn == "Y"'>amt5_on = replace(#{amt}, ',', '')</if>
		   	</if>
		     , mod_dttm = now()
		     , mod_user = #{modUserSeq}
		 where 1 = 1
		   and zemos_idx  = #{zemosIdx}
		   and wrkplc_idx = #{wrkplcIdx}
		   and store_seq  = #{storeSeq}
		   and goal_seq   = #{goalSeq}
		   and year       = #{year}
		   and mm         = #{mm}
		   and item_seq   = #{itemSeq}
		   <if test='unitYn == "1"'> and unit_seq1 = #{unitSeq}</if>
		   <if test='unitYn == "2"'> and unit_seq2 = #{unitSeq}</if>
		   <if test='unitYn == "3"'> and unit_seq3 = #{unitSeq}</if>
		   <if test='unitYn == "4"'> and unit_seq4 = #{unitSeq}</if>
		   <if test='unitYn == "5"'> and unit_seq5 = #{unitSeq}</if>
	</update>
	
	<!-- 엑셀 다운로드 -->
	<select id="selectExcelDown" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectExcelDown */
		select a.zemos_idx as zemosIdx
			 , a.wrkplc_idx as wrkplcIdx
			 , a.store_seq as storeSeq
			 , a.store_nm as storeNm
			 , b.item_seq as itemSeq
			 , b.item_nm as itemNm
			 , #{unitNm} as unitNm
			 , #{onoffNm} as onoffNm
			 , (select year from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.year = #{year} group by year) as year
			 <if test='unitGubun == "1"'>
			 	<if test='onoffNm == "오프라인"'>
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>
			 	<if test='onoffNm == "온라인"'>
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>	
			 </if>
			 <if test='unitGubun == "2"'>
			 	<if test='onoffNm == "오프라인"'>
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt2 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>
			 	<if test='onoffNm == "온라인"'>
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt2_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>	
			 </if>
			 <if test='unitGubun == "3"'>
			 	<if test='onoffNm == "오프라인"'>
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt3 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>
			 	<if test='onoffNm == "온라인"'>
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt3_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>	
			 </if>
			 <if test='unitGubun == "4"'>
			 	<if test='onoffNm == "오프라인"'>
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt4 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>
			 	<if test='onoffNm == "온라인"'>
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt4_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>	
			 </if>
			 <if test='unitGubun == "5"'>
			 	<if test='onoffNm == "오프라인"'>
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt5 from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>
			 	<if test='onoffNm == "온라인"'>
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '01'), 0) as month1
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '02'), 0) as month2
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '03'), 0) as month3
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '04'), 0) as month4
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '05'), 0) as month5
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '06'), 0) as month6
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '07'), 0) as month7
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '08'), 0) as month8
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '09'), 0) as month9
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '10'), 0) as month10
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '11'), 0) as month11
			 , ifnull((select amt5_on from ZM_SALES_GOAL d where d.zemos_idx = a.zemos_idx and d.wrkplc_idx = a.wrkplc_idx and d.store_seq = a.store_seq and d.item_seq = b.item_seq and d.year = #{year} and d.mm = '12'), 0) as month12
			 	</if>	
			 </if>
		  from ZM_SALES_STORE a
		  LEFT OUTER JOIN ZM_SALES_ITEM b ON a.zemos_idx = b.zemos_idx
		  AND a.wrkplc_idx = b.wrkplc_idx
		  JOIN ZM_SALES_STORE_DETAIL_ITEM e ON a.zemos_idx = e.zemos_idx
		  AND a.wrkplc_idx = e.wrkplc_idx
	 	  AND b.item_seq = e.item_seq
		  AND e.use_yn ='Y'
		  <if test='storeSeq != null and storeSeq != ""'>
	      AND e.store_seq = #{storeSeq}
	      </if>
		  
		 where 1 = 1
		   and a.zemos_idx = #{zemosIdx}
		   and a.wrkplc_idx = #{wrkplcIdx}
		   <if test='storeSeq != null and storeSeq != ""'>
		   and a.store_seq = #{storeSeq}
		   </if>
		   and a.store_seq IN ( SELECT store_seq FROM ZM_SALES_STORE_DETAIL 
		   						 WHERE 1=1
		   						 <if test='unitGubun == "1"'> and unit1_yn ='Y' </if>
		   						 <if test='unitGubun == "2"'> and unit2_yn ='Y' </if>
		   						 <if test='unitGubun == "3"'> and unit3_yn ='Y' </if>
		   						 <if test='unitGubun == "4"'> and unit4_yn ='Y' </if>
		   						 <if test='unitGubun == "5"'> and unit5_yn ='Y' </if>
		  						 )
		   <if test='onoffNm == "오프라인"'>						 
		   and off_yn  ='Y'
		   </if>
		   <if test='onoffNm == "온라인"'>
		   and on_yn ='Y'	
		   </if>					 
		   and a.use_yn = 'Y'
		 order by a.store_nm
	</select>
	
	<!-- 매장명이 ZM_SALES_STORE 테이블에 등록 매장과 엑셀의 매장이 맞는지 체크. -->
	<select id="selectStoreNm" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectStoreNm */
		select store_nm as storeNm
			 , store_seq as storeSeq
		  from ZM_SALES_STORE
		 where 1 = 1
		   and zemos_idx = #{zemosIdx}
		   and wrkplc_idx = #{wrkplcIdx}
		   and use_yn = 'Y'
		 order by store_nm
	</select>
	
	<!-- 품목명으로 SEQ 계산 -->
	<select id="selectitemList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectitemList */
		   select a.item_nm as itemNm
		        , a.item_seq as itemSeq
		   from ZM_SALES_ITEM a
		   where 1 = 1
		   and a.zemos_idx = #{zemosIdx}
		   and a.wrkplc_idx = #{wrkplcIdx}
		   and a.use_yn = 'Y'
		   and a.item_seq  IN (select b.item_seq FROM ZM_SALES_STORE_DETAIL_ITEM b
 							    where b.zemos_idx= #{zemosIdx}
 							      and b.wrkplc_idx = #{wrkplcIdx} 
 							      <if test='storeSeq != null and storeSeq != ""'>
		   							and b.store_seq = #{storeSeq}
		   						  </if> 
 							      and b.use_yn = 'Y' )
 		   and a.item_nm = #{itemNm}				      
		   order by a.item_nm
	</select>
	
	<!-- unit의 SEQ 계산. -->
	<select id="selectUnitList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectUnitList */		 
		SELECT case when a.unit_seq1 <![CDATA[ <> ]]> 0 then '1'
						when a.unit_seq2 <![CDATA[ <> ]]> 0 then '2'
						when a.unit_seq3 <![CDATA[ <> ]]> 0 then '3'
						when a.unit_seq4 <![CDATA[ <> ]]> 0 then '4'
						when a.unit_seq5 <![CDATA[ <> ]]> 0 then '5'
				 ELSE 0 END unitGubun
			  ,case when a.unit_seq1 <![CDATA[ <> ]]> 0 then a.unit_seq1
		 	  	    when a.unit_seq2 <![CDATA[ <> ]]> 0 then a.unit_seq2
		 	    	when a.unit_seq3 <![CDATA[ <> ]]> 0 then a.unit_seq3
		 	    	when a.unit_seq4 <![CDATA[ <> ]]> 0 then a.unit_seq4
		 	    	when a.unit_seq5 <![CDATA[ <> ]]> 0 then a.unit_seq5
		 		 ELSE 0 END unitSeq 
		FROM (
				SELECT case when ifnull(a.unit1_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
																	WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq1)
						 ELSE '0' END AS unit_seq1
						 ,case when ifnull(a.unit2_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
						 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq2)
						 ELSE '0' END AS unit_seq2
						 ,case when ifnull(a.unit3_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
						 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq3)
						 ELSE '0' END AS unit_seq3
						 ,case when ifnull(a.unit4_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
						 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq4)
						 ELSE '0' END AS unit_seq4
						 ,case when ifnull(a.unit5_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
						 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq5)
						 ELSE '0' END AS unit_seq5
				 from ZM_SALES_STORE_DETAIL a 
				where 1 = 1
				   AND a.zemos_idx = #{zemosIdx}
				   AND a.wrkplc_idx = #{wrkplcIdx}
				   <if test='storeNm != null and storeNm != ""'>
				   AND a.store_seq = (SELECT b.store_seq FROM ZM_SALES_STORE b 
									   WHERE b.zemos_idx = #{zemosIdx} AND b.wrkplc_idx = #{wrkplcIdx} AND b.store_nm =#{storeNm})
				   </if>				   
					) a
	</select>
	
	<select id="selectUnitList01" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectUnitList01 */		 
		SELECT b.unitGubun
			  ,b.unitSeq
		from		
		(
				SELECT case when a.unit_seq1 <![CDATA[ <> ]]> 0 then '1'
								when a.unit_seq2 <![CDATA[ <> ]]> 0 then '2'
								when a.unit_seq3 <![CDATA[ <> ]]> 0 then '3'
								when a.unit_seq4 <![CDATA[ <> ]]> 0 then '4'
								when a.unit_seq5 <![CDATA[ <> ]]> 0 then '5'
						 ELSE 0 END unitGubun
					  ,case when a.unit_seq1 <![CDATA[ <> ]]> 0 then a.unit_seq1
				 	  	    when a.unit_seq2 <![CDATA[ <> ]]> 0 then a.unit_seq2
				 	    	when a.unit_seq3 <![CDATA[ <> ]]> 0 then a.unit_seq3
				 	    	when a.unit_seq4 <![CDATA[ <> ]]> 0 then a.unit_seq4
				 	    	when a.unit_seq5 <![CDATA[ <> ]]> 0 then a.unit_seq5
				 		 ELSE 0 END unitSeq 
				FROM (
						SELECT case when ifnull(a.unit1_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
																			WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq1)
								 ELSE '0' END AS unit_seq1
								 ,case when ifnull(a.unit2_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
								 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq2)
								 ELSE '0' END AS unit_seq2
								 ,case when ifnull(a.unit3_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
								 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq3)
								 ELSE '0' END AS unit_seq3
								 ,case when ifnull(a.unit4_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
								 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq4)
								 ELSE '0' END AS unit_seq4
								 ,case when ifnull(a.unit5_yn,'N') ='Y' then (SELECT ifnull(unit_seq,0) FROM ZM_SALES_UNIT 
								 											   WHERE zemos_idx = #{zemosIdx} AND wrkplc_idx = #{wrkplcIdx} AND unit_nm = #{unitName} AND unit_seq = a.unit_seq5)
								 ELSE '0' END AS unit_seq5
						 from ZM_SALES_STORE_DETAIL a 
						where 1 = 1
						   AND a.zemos_idx = #{zemosIdx}
						   AND a.wrkplc_idx = #{wrkplcIdx}
						   <if test='storeNm != null and storeNm != ""'>
						   AND a.store_seq = (SELECT b.store_seq FROM ZM_SALES_STORE b 
											   WHERE b.zemos_idx = #{zemosIdx} AND b.wrkplc_idx = #{wrkplcIdx} AND b.store_nm =#{storeNm})
						   </if>				   
							) a
						) b
					where 1=1 
					and b.unitGubun <![CDATA[ <> ]]> '0'
		            and b.unitSeq <![CDATA[ <> ]]> '0'		
	</select>
	
	<!-- 목표삭제 -->
	<delete id="deleteGoal" parameterType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.deleteGoal */
		delete
		  from ZM_SALES_GOAL
		 where 1 = 1
		   and zemos_idx  = #{zemosIdx}
		   and wrkplc_idx = #{wrkplcIdx}
		   <if test='gbn == "A"'>
			 and store_seq =  (select store_seq from ZM_SALES_STORE where zemos_idx = #{zemosIdx} and wrkplc_idx = #{wrkplcIdx} and store_nm = #{storeNm})			 
		   </if>
		   <if test='onoffName != null and onoffName != ""'>
		   	 	
		   </if>
		   <if test='year != null and year != ""'>
		   and year       = #{year}
		   </if>
	</delete>
	
	<!-- 목표 등록 여부 count -->
	<select id="selectGoalCnt01" parameterType="java.util.HashMap" resultType="java.lang.Integer">
		/* zenielm.zemos3.family.sales2.sales2Goal.selectGoalCnt01 */
		       SELECT COUNT(DISTINCT a.STORE_SEQ) AS goalCnt
					FROM ZM_SALES_GOAL a
					WHERE 1=1
					<if test='zemosIdx != null and zemosIdx != ""'>
				  	 and a.zemos_idx = #{zemosIdx}
				   </if>
				   <if test='wrkplcIdx != null and wrkplcIdx != ""'>
				     and a.wrkplc_idx = #{wrkplcIdx}
				   </if>
				   <if test='gbn == "O"'>
					 and a.store_seq = #{storeSeq}
					 and a.itemSeq = #{itemSeq}
				   </if>
				   <if test='gbn == "A"'>
					 and a.store_seq =  (select store_seq from ZM_SALES_STORE where zemos_idx = #{zemosIdx} and wrkplc_idx = #{wrkplcIdx} and store_nm = #{storeNm})
					 and a.item_seq =  (select item_seq from ZM_SALES_ITEM where zemos_idx = #{zemosIdx} and wrkplc_idx = #{wrkplcIdx} and item_nm = #{itemNm})
				   </if>	 
				   <if test='year != null and year != ""'> 
				     and a.year = #{year}
				   </if>
				   <if test='mm != null and mm != ""'> 
				     and a.mm = #{mm}
				   </if>
	</select>
	
	<!-- 목표등록 -->
	<insert id="insertGoal" parameterType="java.util.HashMap" useGeneratedKeys="true" keyProperty="goal_seq">
		/* zenielm.zemos3.family.sales2.sales2Goal.insertGoal */
		insert into ZM_SALES_GOAL
		(
			zemos_idx
			, wrkplc_idx
			, store_seq
			<!-- 박수호 수정 시작 -->
			, item_seq
			<!-- 박수호 수정 종료 -->
			<if test='unitGubun == "1"'>
			, unit_seq1
				<if test='onoffName == "오프라인"'> , amt </if>
				<if test='onoffName == "온라인"'> , amt_on </if>
			</if>
			<if test='unitGubun == "2"'>
			, unit_seq2
				<if test='onoffName == "오프라인"'> , amt2 </if>
				<if test='onoffName == "온라인"'> , amt2_on </if>
			</if>
			<if test='unitGubun == "3"'>
			, unit_seq3
				<if test='onoffName == "오프라인"'> , amt3 </if>
				<if test='onoffName == "온라인"'> , amt3_on </if>
			</if>
			<if test='unitGubun == "4"'>
			, unit_seq4
				<if test='onoffName == "오프라인"'> , amt4 </if>
				<if test='onoffName == "온라인"'> , amt4_on </if>
			</if>
			<if test='unitGubun == "5"'>
			, unit_seq5
				<if test='onoffName == "오프라인"'> , amt5 </if>
				<if test='onoffName == "온라인"'> , amt5_on </if>
			</if>
			, year
			, mm  
			, reg_dttm
			, reg_user
			, mod_dttm
			, mod_user		
		)
		values
		(
			#{zemosIdx}
			, #{wrkplcIdx}
			<if test='gbn == "A"'>
			, (select store_seq from ZM_SALES_STORE where zemos_idx = #{zemosIdx} and wrkplc_idx = #{wrkplcIdx} and store_nm = #{storeNm})
			</if>
			<if test='gbn == "O"'>
			, #{storeSeq}
			</if>
			<!-- 박수호 수정 시작 -->
			, #{itemSeq}
			<!-- 박수호 수정 종료 -->
			, #{unitSeq}
			, #{amt}
			, #{year}
			, #{mm}
			, NOW()
			, #{regUserSeq}
			, NOW()
			, #{regUserSeq}
		)
	</insert>
	
	<!-- 목표등록 update -->
	<update id="updateGoal" parameterType="java.util.HashMap">
		/* zenielm.zemos3.family.sales2.sales2Goal.updateGoal */
		update ZM_SALES_GOAL
		   set 
		    <if test='unitGubun == "1"'>
		   		unit_seq1 = #{unitSeq}		   
		   	<if test='onoffName == "오프라인"'>,amt = #{amt}</if>   
		   	<if test='onoffName == "온라인"'>,amt_on = #{amt}</if>  
		   	</if>
		   	<if test='unitGubun == "2"'>
		   		unit_seq2 = #{unitSeq}		   
		   	<if test='onoffName == "오프라인"'>,amt2 = #{amt}</if>   
		   	<if test='onoffName == "온라인"'>,amt2_on = #{amt}</if>  
		   	</if>
		   	<if test='unitGubun == "3"'>
		   		unit_seq3 = #{unitSeq}		   
		   	<if test='onoffName == "오프라인"'>,amt3 = #{amt}</if>   
		   	<if test='onoffName == "온라인"'>,amt3_on = #{amt}</if>  
		   	</if>
		   	<if test='unitGubun == "4"'>
		   		unit_seq4 = #{unitSeq}		   
		   	<if test='onoffName == "오프라인"'>,amt4 = #{amt}</if>   
		   	<if test='onoffName == "온라인"'>,amt4_on = #{amt}</if>  
		   	</if>
		   	<if test='unitGubun == "5"'>
		   		unit_seq5 = #{unitSeq}		   
		   	<if test='onoffName == "오프라인"'>,amt5 = #{amt}</if>   
		   	<if test='onoffName == "온라인"'>,amt5_on = #{amt}</if>  
		   	</if>
		     , mod_dttm = now()
		     , mod_user = #{modUserSeq}
		 where 1 = 1
		   and zemos_idx  = #{zemosIdx}
		   and wrkplc_idx = #{wrkplcIdx}
		   <if test='gbn == "A"'> and store_seq  = (select store_seq from ZM_SALES_STORE where zemos_idx = #{zemosIdx} and wrkplc_idx = #{wrkplcIdx} and store_nm = #{storeNm})</if>
		   <if test='gbn == "O"'> and store_seq  = #{storeSeq}</if>
		   and item_seq   = #{itemSeq}
		   and year       = #{year}
		   and mm         = #{mm}
	</update>
</mapper>